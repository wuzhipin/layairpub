!function(t,e){"use strict";var i;t.PhysicsShape=void 0,(i=t.PhysicsShape||(t.PhysicsShape={}))[i.BoxShape=0]="BoxShape",i[i.CircleShape=1]="CircleShape",i[i.PolygonShape=2]="PolygonShape",i[i.ChainShape=3]="ChainShape",i[i.EdgeShape=4]="EdgeShape";class o{}class s{}s.allowSleeping=!1,s.gravity={x:0,y:9.8},s.customUpdate=!1,s.velocityIterations=8,s.positionIterations=3,s.pixelRatio=50,s.debugDraw=!0,s.drawShape=!0,s.drawJoint=!0,s.drawAABB=!1,s.drawCenterOfMass=!1;class a extends e.EventDispatcher{constructor(){super(...arguments),this._eventList=[]}static get I(){return a._I||(a._I=new a)}set enableDebugDraw(t){t?this._factory.createDebugDraw(this._factory.drawFlags_shapeBit):this._factory.removeDebugDraw()}set drawShape(t){let e=this._factory.drawFlags_shapeBit;t?this._factory.appendFlags(e):this._factory.clearFlags(e)}set drawJoint(t){let e=this._factory.drawFlags_jointBit;t?this._factory.appendFlags(e):this._factory.clearFlags(e)}set drawAABB(t){let e=this._factory.drawFlags_aabbBit;t?this._factory.appendFlags(e):this._factory.clearFlags(e)}set drawPair(t){let e=this._factory.drawFlags_pairBit;t?this._factory.appendFlags(e):this._factory.clearFlags(e)}set drawCenterOfMass(t){let e=this._factory.drawFlags_centerOfMassBit;t?this._factory.appendFlags(e):this._factory.clearFlags(e)}get allowSleeping(){return this._factory.allowSleeping}set allowSleeping(t){this._factory.allowSleeping=t}get gravity(){return this._factory.gravity}set gravity(t){this._factory.gravity=t}get worldRoot(){return this._worldRoot||e.ILaya.stage}set worldRoot(t){if(this._worldRoot=t,t){var i=t.localToGlobal(e.Point.TEMP.setTo(0,0));this._factory.shiftOrigin(-i.x,-i.y)}}get bodyCount(){return this._factory.bodyCount}get contactCount(){return this._factory.contactCount}get jointCount(){return this._factory.jointCount}_addRigidBody(t){this._rigiBodyList.add(t)}_removeRigidBody(t){this._rigiBodyList.remove(t)}_updataRigidBodyAttribute(t){this._updataattributeLists.add(t)}_removeRigidBodyAttribute(t){this._updataattributeLists.remove(t)}_update(){for(var t=0,i=this._updataattributeLists.length;t<i;t++)this._updataattributeLists.elements[t]._updatePhysicsAttribute();this._updataattributeLists.clear();var o=Math.min(e.ILaya.timer.delta/1e3,.033);this._factory.update(o),this._updatePhysicsTransformToRender();var s=this._eventList.length;if(s>0){for(t=0;t<s;t+=2)this._factory.sendEvent(this._eventList[t],this._eventList[t+1]);this._eventList.length=0}}_updatePhysicsTransformToRender(){for(var t=0,e=this._rigiBodyList.length;t<e;t++)this._rigiBodyList.elements[t]._updatePhysicsTransformToRender()}enable(){return this._factory?(null!=e.PlayerConfig.physics2D&&Object.assign(s,e.PlayerConfig.physics2D),this._factory.initialize().then((()=>(this.start(),Promise.resolve())))):Promise.resolve()}start(){this._enabled?e.ILaya.physicsTimer.clear(this,this._update):(this._enabled=!0,this._factory.start(),this.allowSleeping=s.allowSleeping,this._emptyBody=this._factory.createBody(null)),s.debugDraw?(this.enableDebugDraw=!0,this.drawShape=s.drawShape,this.drawJoint=s.drawJoint,this.drawAABB=s.drawAABB,this.drawCenterOfMass=s.drawCenterOfMass):this.enableDebugDraw=!1,this._rigiBodyList?this._rigiBodyList.clear():this._rigiBodyList=new e.SingletonList,this._updataattributeLists?this._updataattributeLists.clear():this._updataattributeLists=new e.SingletonList,!s.customUpdate&&e.LayaEnv.isPlaying&&e.ILaya.physicsTimer.frameLoop(1,this,this._update)}destroyWorld(){this._enabled=!1,this._factory.destroyWorld(),e.ILaya.physicsTimer.clear(this,this._update)}stop(){this._rigiBodyList.clear(),this._updataattributeLists.clear(),e.ILaya.physicsTimer.clear(this,this._update)}getBodyCount(){return this._factory.bodyCount}getContactCount(){return this._factory.contactCount}getJointCount(){return this._factory.jointCount}updatePhysicsByWorldRoot(){if(this.worldRoot){var t=this.worldRoot.localToGlobal(e.Point.TEMP.setTo(0,0));this._factory.shiftOrigin(-t.x,-t.y)}}}e.Laya.addInitCallback((()=>a.I.enable()));class r{constructor(){this.position=new e.Vector2,this.linearVelocity=new e.Vector2}}class n extends e.Component{constructor(){super(...arguments),this._type="dynamic",this._allowSleep=!0,this._angularVelocity=0,this._angularDamping=0,this._linearVelocity={x:0,y:0},this._linearDamping=0,this._bullet=!1,this._allowRotation=!0,this._gravityScale=1,this.group=0,this.category=1,this.mask=-1,this.label="RigidBody"}get body(){return this._body||this._onAwake(),this._body}get type(){return this._type}set type(t){this._type=t,this._updateBodyType()}get gravityScale(){return this._gravityScale}set gravityScale(t){this._gravityScale=t,this._body&&a.I._factory.set_rigidBody_gravityScale(this._body,t)}get allowRotation(){return this._allowRotation}set allowRotation(t){this._allowRotation=t,this._body&&a.I._factory.set_rigidBody_allowRotation(this._body,!t)}get allowSleep(){return this._allowSleep}set allowSleep(t){this._allowSleep=t,this._body&&a.I._factory.set_rigidBody_allowSleep(this._body,t)}get angularDamping(){return this._angularDamping}set angularDamping(t){this._angularDamping=t,this._body&&a.I._factory.set_rigidBody_angularDamping(this._body,t)}get angularVelocity(){return this._body?a.I._factory.get_rigidBody_angularVelocity(this._body):this._angularVelocity}set angularVelocity(t){this._angularVelocity=t,"static"!=this._type&&this._body&&a.I._factory.set_rigidBody_angularVelocity(this.body,t)}get linearDamping(){return this._linearDamping}set linearDamping(t){this._linearDamping=t,this._body&&a.I._factory.set_rigidBody_linearDamping(this._body,t)}get linearVelocity(){if(this._body){var t=a.I._factory.get_rigidBody_linearVelocity(this._body);return{x:t.x,y:t.y}}return this._linearVelocity}set linearVelocity(t){t&&(t instanceof Array&&(t={x:t[0],y:t[1]}),this._linearVelocity=t,"static"!=this._type&&this._body&&a.I._factory.set_rigidBody_linearVelocity(this._body,t))}get bullet(){return this._bullet}set bullet(t){this._bullet=t,this._body&&a.I._factory.set_rigidBody_bullet(this._body,t)}_createBody(){if(this._body||!this.owner)return;let t=a.I._factory;var i=this.owner,o=new r;o.position.setValue(i.globalPosX,i.globalPosY),o.angle=e.Utils.toRadian(i.globalRotation),o.allowSleep=this._allowSleep,o.angularDamping=this._angularDamping,o.bullet=this._bullet,o.fixedRotation=!this._allowRotation,o.gravityScale=this._gravityScale,o.linearDamping=this._linearDamping,o.group=this.group;var s=this._linearVelocity;o.type=this._type,"static"==this._type?(o.angularVelocity=0,o.linearVelocity.setValue(0,0)):(o.angularVelocity=this._angularVelocity,(s&&0!=s.x||0!=s.y)&&o.linearVelocity.setValue(s.x,s.y)),this._body=t.rigidBodyDef_Create(o),this._needrefeshShape(),this._updateBodyType()}_updateBodyType(){this._body&&(a.I._factory.set_rigidBody_type(this.body,this._type),"static"==this.type?a.I._removeRigidBody(this):a.I._addRigidBody(this))}_onAwake(){this.owner.cacheGlobal=!0,this._createBody(),this.owner.on("GlobaChange",this,this._globalChangeHandler)}_globalChangeHandler(t){t&n.changeFlag&&this._needrefeshShape()}_onEnable(){this.owner.cacheGlobal=!0,this._createBody(),this.owner.on("GlobaChange",this,this._globalChangeHandler)}_needrefeshShape(){a.I._updataRigidBodyAttribute(this)}_updatePhysicsAttribute(){var t=a.I._factory,i=this.owner;t.set_RigibBody_Transform(this._body,i.globalPosX,i.globalPosY,e.Utils.toRadian(this.owner.globalRotation));var o=this.owner.getComponents(h);if(o){for(var s=0,r=o.length;s<r;s++){var n=o[s];n.rigidBody=this,n._refresh()}t.retSet_rigidBody_MassData(this._body),t.set_rigidbody_Awake(this._body,!0),this.owner.event("shapeChange")}}_updatePhysicsTransformToRender(){if("static"!=this.type){var t=a.I._factory;if(a.I._factory.get_rigidBody_IsAwake(this._body)){var i=e.Vector2.TempVector2;t.get_RigidBody_Position(this.body,i);var o=this.owner;o.setGlobalPos(i.x,i.y),o.globalRotation=e.Utils.toAngle(t.get_RigidBody_Angle(this.body))}}}_onDisable(){a.I._removeRigidBody(this),a.I._removeRigidBodyAttribute(this),this.owner.off("GlobaChange",this,this._globalChangeHandler),this.owner.cacheGlobal=!1,this._body&&a.I._factory.removeBody(this._body),this._body=null}_onDestroy(){a.I._removeRigidBody(this),a.I._removeRigidBodyAttribute(this),this.owner.off("GlobaChange",this,this._globalChangeHandler),this._body&&a.I._factory.removeBody(this._body),this._body=null}_getOriBody(){return this._body}getBody(){return this._body||this._onAwake(),this._body}applyForce(t,e){this._body||this._onAwake(),a.I._factory.rigidBody_applyForce(this._body,e,t)}applyForceToCenter(t){this._body||this._onAwake(),a.I._factory.rigidBody_applyForceToCenter(this._body,t)}applyLinearImpulse(t,e){this._body||this._onAwake(),a.I._factory.rigidbody_ApplyLinearImpulse(this._body,e,t)}applyLinearImpulseToCenter(t){this._body||this._onAwake(),a.I._factory.rigidbody_ApplyLinearImpulseToCenter(this._body,t)}applyTorque(t){this._body||this._onAwake(),a.I._factory.rigidbody_applyTorque(this._body,t)}setVelocity(t){this._body||this._onAwake(),a.I._factory.set_rigidBody_linearVelocity(this._body,t)}setAngle(t){this._body||this._onAwake();var e=a.I._factory,i=this.owner;e.set_RigibBody_Transform(this._body,i.globalPosX,i.globalPosY,t),e.set_rigidbody_Awake(this._body,!0)}getMass(){return this._body?a.I._factory.get_rigidbody_Mass(this._body):0}getCenter(){return this._body||this._onAwake(),a.I._factory.get_rigidBody_Center(this._body)}getWorldCenter(){return this._body||this._onAwake(),a.I._factory.get_rigidBody_WorldCenter(this._body)}getWorldPoint(t,e){return this.owner._getGlobalCacheLocalToGlobal(t,e)}getLocalPoint(t,e){return this.owner._getGlobalCacheGlobalToLocal(t,e)}}n.changeFlag=e.Sprite.Sprite_GlobalDeltaFlage_Position_X|e.Sprite.Sprite_GlobalDeltaFlage_Position_Y|e.Sprite.Sprite_GlobalDeltaFlage_Rotation|e.Sprite.Sprite_GlobalDeltaFlage_Scale_X|e.Sprite.Sprite_GlobalDeltaFlage_Scale_Y;class h extends e.Component{get scaleX(){return this.owner.globalScaleX}get scaleY(){return this.owner.globalScaleY}get pivotoffx(){return this._x-this.owner.pivotX}get pivotoffy(){return this._y-this.owner.pivotY}get x(){return this._x}set x(t){this._x!=t&&(this._x=t,this._needupdataShapeAttribute())}get y(){return this._y}set y(t){this._y!=t&&(this._y=t,this._needupdataShapeAttribute())}get isSensor(){return this._isSensor}set isSensor(t){this._isSensor!=t&&(this._isSensor=t,this._needupdataShapeAttribute())}get density(){return this._density}set density(t){this._density!=t&&(this._density=t,this._needupdataShapeAttribute())}get friction(){return this._friction}set friction(t){this._friction!=t&&(this._friction=t,this._needupdataShapeAttribute())}get restitution(){return this._restitution}set restitution(t){this._restitution!=t&&(this._restitution=t,this._needupdataShapeAttribute())}constructor(){super(),this._isSensor=!1,this._density=10,this._friction=.2,this._restitution=0,this._x=0,this._y=0,this._singleton=!1}_setShapeData(t){throw"ColliderBase: must override it."}_createfixture(){let t=a.I._factory;var e=this.rigidBody.body,i=h.TempDef;i.density=this.density,i.friction=this.friction,i.isSensor=this.isSensor,i.restitution=this.restitution,i.shape=this._physicShape;let o=t.createFixtureDef(i);this._setShapeData(o._shape),this._fixture=t.createfixture(e,o)}resetFixtureData(){var t=h.TempDef;t.density=this.density,t.friction=this.friction,t.isSensor=this.isSensor,t.restitution=this.restitution,a.I._factory.resetFixtureData(this._fixture,t),this._setShapeData(this._fixture.shape)}_onEnable(){this.owner.getComponent(n)&&(this.rigidBody=this.owner.getComponent(n),this._needupdataShapeAttribute())}_onAwake(){this.owner.getComponent(n)&&(this.rigidBody=this.owner.getComponent(n),this._needupdataShapeAttribute())}_needupdataShapeAttribute(){this.rigidBody&&this.rigidBody._needrefeshShape()}_refresh(){if(!this.enabled)return;let t=a.I._factory;this._fixture?this.resetFixtureData():this._createfixture(),t.set_fixtureDef_GroupIndex(this._fixture,this.rigidBody.group),t.set_fixtureDef_CategoryBits(this._fixture,this.rigidBody.category),t.set_fixtureDef_maskBits(this._fixture,this.rigidBody.mask),t.set_fixture_collider(this._fixture,this)}_onDisable(){let t=a.I._factory;this._fixture&&this.rigidBody._getOriBody()&&t.rigidBody_DestroyFixture(this.rigidBody.body,this._fixture),this._fixture=null,this.rigidBody=null}}h.TempDef=new o;class _ extends h{get width(){return this._width}set width(t){if(t<=0)throw"BoxCollider size cannot be less than 0";this._width!=t&&(this._width=t,this._needupdataShapeAttribute())}get height(){return this._height}set height(t){if(t<=0)throw"BoxCollider size cannot be less than 0";this._height!=t&&(this._height=t,this._needupdataShapeAttribute())}constructor(){super(),this._width=100,this._height=100,this._physicShape=t.PhysicsShape.BoxShape}_setShapeData(t){let e=.5*this._width,i=.5*this._height;var o={x:e+this.pivotoffx,y:i+this.pivotoffy};a.I._factory.set_collider_SetAsBox(t,e,i,o,Math.abs(this.scaleX),Math.abs(this.scaleY))}}class l extends h{get points(){return this._points}set points(t){if(!t)throw"ChainCollider points cannot be empty";this._points=t;var e=this._points.split(",");let i=e.length;this._datas=[];for(var o=0,s=i;o<s;o++)this._datas.push(parseInt(e[o]));this._needupdataShapeAttribute()}get datas(){return this._datas}set datas(t){if(!t)throw"ChainCollider datas cannot be empty";this._datas=t,this._needupdataShapeAttribute()}get loop(){return this._loop}set loop(t){this._loop!=t&&(this._loop=t,this._needupdataShapeAttribute())}constructor(){super(),this._points="0,0,100,0",this._datas=[],this._loop=!1,this._physicShape=t.PhysicsShape.ChainShape}_setShapeData(t){if(this._datas.length%2==1)throw"ChainCollider datas lenth must a multiplier of 2";a.I._factory.set_ChainShape_data(t,this.pivotoffx,this.pivotoffy,this._datas,this._loop,this.scaleX,this.scaleY)}onAdded(){if(super.onAdded(),0==this._datas.length){let t=this.owner;this._datas.push(0,0,t.width,0,0,t.height,t.width,t.height)}}}class d extends h{get radius(){return this._radius}set radius(t){if(t<=0)throw"CircleCollider radius cannot be less than 0";this._radius!=t&&(this._radius=t,this._needupdataShapeAttribute())}constructor(){super(),this._radius=50,this._physicShape=t.PhysicsShape.CircleShape}_setShapeData(t){var e=Math.max(Math.abs(this.scaleX),Math.abs(this.scaleY));let i=this.radius;a.I._factory.set_CircleShape_radius(t,i,e),a.I._factory.set_CircleShape_pos(t,this.x,this.y,e)}}class c extends h{get points(){return this._points}set points(t){if(!t)throw"EdgeCollider points cannot be empty";this._points=t;var e=this._points.split(",");let i=e.length;this._datas=[];for(var o=0,s=i;o<s;o++)this._datas.push(parseInt(e[o]));this._needupdataShapeAttribute()}get datas(){return this._datas}set datas(t){if(!t)throw"EdgeCollider points cannot be empty";this._datas=t,this._needupdataShapeAttribute()}constructor(){super(),this._points="0,0,100,0",this._datas=[0,0,100,0],this._physicShape=t.PhysicsShape.EdgeShape}_setShapeData(t){if(this._datas.length%2==1)throw"EdgeCollider points lenth must a multiplier of 2";a.I._factory.set_EdgeShape_data(t,this.pivotoffx,this.pivotoffy,this._datas,this.scaleX,this.scaleY)}}class y extends h{get points(){return this._points}set points(t){if(!t)throw"PolygonCollider points cannot be empty";this._points=t;var e=this._points.split(",");let i=e.length;this._datas=[];for(var o=0,s=i;o<s;o++)this._datas.push(parseInt(e[o]));this._needupdataShapeAttribute()}get datas(){return this._datas}set datas(t){if(!t)throw"PolygonCollider points cannot be empty";this._datas=t,this._needupdataShapeAttribute()}constructor(){super(),this._points="50,0,100,100,0,100",this._datas=[50,0,100,100,0,100],this._physicShape=t.PhysicsShape.PolygonShape}_setShapeData(t){var e=this.datas.length;if(e<6)throw"PolygonCollider points must be greater than 3";if(e%2==1)throw"PolygonCollider points lenth must a multiplier of 2";a.I._factory.set_PolygonShape_data(t,this.pivotoffx,this.pivotoffy,this.datas,this.scaleX,this.scaleY)}}class p extends e.Component{get joint(){return this._joint||this._createJoint(),this._joint}constructor(){super(),this._factory=a.I._factory,this._singleton=!1}getBodyAnchor(t,i,o){e.Point.TEMP.setTo(i,o);let s=t.owner;return s&&(s.transform?s.transform.transformPointN(e.Point.TEMP):(e.Point.TEMP.x*=s.scaleX,e.Point.TEMP.y*=s.scaleY)),e.Point.TEMP}_onEnable(){this._createJoint()}_onAwake(){this._createJoint()}_createJoint(){}_onDisable(){this._joint&&this._factory.getJoint_userData(this._joint)&&!this._factory.getJoint_userData_destroy(this._joint)&&a.I._factory.removeJoint(this._joint),this._joint=null}}class g{constructor(){this.localAnchorA=new e.Vector2,this.localAnchorB=new e.Vector2}}class u{}class f{constructor(){this.linearOffset=new e.Vector2}}class m{constructor(){this.target=new e.Vector2}}class b{constructor(){this.anchor=new e.Vector2,this.axis=new e.Vector2}}class w{constructor(){this.groundAnchorA=new e.Vector2,this.groundAnchorB=new e.Vector2,this.localAnchorA=new e.Vector2,this.localAnchorB=new e.Vector2}}class B{constructor(){this.anchor=new e.Vector2}}class S{constructor(){this.anchor=new e.Vector2}}class x{constructor(){this.anchor=new e.Vector2,this.axis=new e.Vector2}}class A extends p{constructor(){super(...arguments),this._length=0,this._maxLength=-1,this._minLength=-1,this._frequency=1,this._dampingRatio=0,this.selfAnchor=[0,0],this.otherAnchor=[0,0],this.collideConnected=!1}get length(){return this._length}set length(t){this._length=t,this._joint&&this._factory.set_DistanceJoint_length(this._joint,t)}get minLength(){return this._minLength}set minLength(t){this._minLength=t,this._joint&&this._factory.set_DistanceJoint_MinLength(this._joint,t)}get maxLength(){return this._maxLength}set maxLength(t){this._maxLength=t,this._joint&&this._factory.set_DistanceJoint_MaxLength(this._joint,t)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._joint&&this._factory.set_DistanceJointStiffnessDamping(this._joint,this._frequency,this._dampingRatio)}get damping(){return this._dampingRatio}set damping(t){this._dampingRatio=t,this._joint&&this._factory.set_DistanceJointStiffnessDamping(this._joint,this._frequency,this._dampingRatio)}get jointLength(){return this._joint?this._factory.phyToLayaValue(this.joint.GetLength()):0}_createJoint(){if(!this._joint){let e=this.owner;if(this.selfBody=this.selfBody||e.getComponent(n),!this.selfBody)throw"selfBody can not be empty";let i=this.getBodyAnchor(this.selfBody,this.selfAnchor[0],this.selfAnchor[1]);var t=A._temp||(A._temp=new g);t.bodyB=this.selfBody.getBody(),t.localAnchorB.setValue(i.x,i.y),this.selfBody.owner.on("shapeChange",this,this._refeahJoint),this.otherBody?(t.bodyA=this.otherBody.getBody(),i=this.getBodyAnchor(this.otherBody,this.otherAnchor[0],this.otherAnchor[1]),t.localAnchorA.setValue(i.x,i.y),this.otherBody.owner.on("shapeChange",this,this._refeahJoint)):(t.bodyA=a.I._emptyBody,t.localAnchorA.setValue(this.otherAnchor[0],this.otherAnchor[1])),t.dampingRatio=this._dampingRatio,t.frequency=this._frequency,t.collideConnected=this.collideConnected,t.length=this._length,t.maxLength=this._maxLength,t.minLength=this._minLength,this._joint=this._factory.createDistanceJoint(t)}}_refeahJoint(){this._joint&&this._factory.set_DistanceJointStiffnessDamping(this._joint,this._frequency,this._dampingRatio)}onDestroy(){super.onDestroy(),this.selfBody.owner.off("shapeChange",this._refeahJoint),this.otherBody&&this.otherBody.owner.off("shapeChange",this._refeahJoint)}}class C extends p{constructor(){super(...arguments),this._ratio=1,this.collideConnected=!1}get ratio(){return this._ratio}set ratio(t){this._ratio=t,this._joint&&this._factory.set_GearJoint_SetRatio(this._joint,t)}_createJoint(){if(!this._joint){if(!this.joint1)throw"Joint1 can not be empty";if(!this.joint2)throw"Joint2 can not be empty";var t=C._temp||(C._temp=new u);t.bodyA=this.joint1.owner.getComponent(n).getBody(),t.bodyB=this.joint2.owner.getComponent(n).getBody(),t.joint1=this.joint1.joint,t.joint2=this.joint2.joint,t.ratio=-this._ratio,t.collideConnected=this.collideConnected,this._joint=this._factory.create_GearJoint(t)}}}class D extends p{constructor(){super(...arguments),this._linearOffset=[0,0],this._angularOffset=0,this._maxForce=1e3,this._maxTorque=1e3,this._correctionFactor=.3,this.collideConnected=!1}get linearOffset(){return this._linearOffset}set linearOffset(t){this._linearOffset=t,this._joint&&this._factory.set_MotorJoint_linearOffset(this._joint,t[0],t[1])}get angularOffset(){return this._angularOffset}set angularOffset(t){this._angularOffset=t,this._joint&&this._factory.set_MotorJoint_SetAngularOffset(this._joint,e.Utils.toRadian(-t))}get maxForce(){return this._maxForce}set maxForce(t){this._maxForce=t,this._joint&&this._factory.set_MotorJoint_SetMaxForce(this._joint,t)}get maxTorque(){return this._maxTorque}set maxTorque(t){this._maxTorque=t,this._joint&&this._factory.set_MotorJoint_SetMaxTorque(this._joint,t)}get correctionFactor(){return this._correctionFactor}set correctionFactor(t){this._correctionFactor=t,this._joint&&this._factory.set_MotorJoint_SetCorrectionFactor(this._joint,t)}_createJoint(){if(!this._joint){if(!this.otherBody)throw"otherBody can not be empty";if(this.selfBody=this.selfBody||this.owner.getComponent(n),!this.selfBody)throw"selfBody can not be empty";var t=D._temp||(D._temp=new f);t.bodyA=this.selfBody.getBody(),t.bodyB=this.otherBody.getBody(),t.linearOffset.setValue(this._linearOffset[0],this._linearOffset[1]),t.angularOffset=e.Utils.toRadian(-this._angularOffset),t.maxForce=this._maxForce,t.maxTorque=this._maxTorque,t.correctionFactor=this._correctionFactor,t.collideConnected=this.collideConnected,this._joint=this._factory.create_MotorJoint(t)}}}class M extends p{constructor(){super(...arguments),this._maxForce=1e3,this._frequency=5,this._dampingRatio=.7}get maxForce(){return this._maxForce}set maxForce(t){this._maxForce=t,this._joint&&this._factory.set_MotorJoint_SetMaxForce(this._joint,t)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._joint&&this._factory.set_MouseJoint_frequencyAndDampingRatio(this._joint,this._frequency,this._dampingRatio)}get damping(){return this._dampingRatio}set damping(t){this._dampingRatio=t,this._joint&&this._factory.set_MouseJoint_frequencyAndDampingRatio(this._joint,this._frequency,this._dampingRatio)}_onEnable(){this.owner.mouseEnabled=!0,this.owner.on(e.Event.MOUSE_DOWN,this,this._onMouseDown)}_createJoint(){if(!this._joint){if(this.selfBody=this.selfBody||this.owner.getComponent(n),!this.selfBody)throw"selfBody can not be empty";var t=M._temp||(M._temp=new m);if(this.anchor)var i=this.selfBody.owner.localToGlobal(e.Point.TEMP.setTo(this.anchor[0],this.anchor[1]),!1,a.I.worldRoot);else i=a.I.worldRoot.globalToLocal(e.Point.TEMP.setTo(e.ILaya.stage.mouseX,e.ILaya.stage.mouseY));t.bodyA=a.I._emptyBody,t.bodyB=this.selfBody.getBody(),t.target.setValue(i.x,i.y),t.maxForce=this._maxForce,t.dampingRatio=this._dampingRatio,t.frequency=this._frequency,this._factory.set_rigidbody_Awake(t.bodyB,!0),this._joint=this._factory.create_MouseJoint(t)}}_onMouseDown(){this._createJoint(),e.ILaya.stage.on(e.Event.MOUSE_MOVE,this,this._onMouseMove),e.ILaya.stage.once(e.Event.MOUSE_UP,this,this._onStageMouseUp),e.ILaya.stage.once(e.Event.MOUSE_OUT,this,this._onStageMouseUp)}_onStageMouseUp(){e.ILaya.stage.off(e.Event.MOUSE_MOVE,this,this._onMouseMove),e.ILaya.stage.off(e.Event.MOUSE_UP,this,this._onStageMouseUp),e.ILaya.stage.off(e.Event.MOUSE_OUT,this,this._onStageMouseUp),this._factory.removeJoint(this._joint),this._joint=null}_onMouseMove(){this._joint&&this._factory.set_MouseJoint_target(this._joint,a.I.worldRoot.mouseX,a.I.worldRoot.mouseY)}_onDisable(){super._onDisable(),this.owner.off(e.Event.MOUSE_DOWN,this,this._onMouseDown)}}class j extends p{constructor(){super(...arguments),this._enableMotor=!1,this._motorSpeed=0,this._maxMotorForce=1e4,this._enableLimit=!1,this._lowerTranslation=0,this._upperTranslation=0,this._axis=[1,0],this.anchor=[0,0],this.angle=0,this.collideConnected=!1}get enableMotor(){return this._enableMotor}set enableMotor(t){this._enableMotor=t,this._joint&&this._factory.set_Joint_EnableMotor(this._joint,t)}get motorSpeed(){return this._motorSpeed}set motorSpeed(t){this._motorSpeed=t,this._joint&&this._factory.set_Joint_SetMotorSpeed(this._joint,t)}get maxMotorForce(){return this._maxMotorForce}set maxMotorForce(t){this._maxMotorForce=t,this._joint&&this._factory.set_Joint_SetMaxMotorTorque(this._joint,t)}get enableLimit(){return this._enableLimit}set enableLimit(t){this._enableLimit=t,this._joint&&this._factory.set_Joint_EnableLimit(this._joint,t)}get lowerTranslation(){return this._lowerTranslation}set lowerTranslation(t){this._lowerTranslation=t,this._joint&&this._factory.set_Joint_SetLimits(this._joint,t,this._upperTranslation)}get upperTranslation(){return this._upperTranslation}set upperTranslation(t){this._upperTranslation=t,this._joint&&this._factory.set_Joint_SetLimits(this._joint,this._lowerTranslation,t)}get axis(){return this._axis}set axis(t){this._axis=t,this.angle=e.Utils.toAngle(Math.atan2(t[1],t[0]))}_createJoint(){if(!this._joint){if(this.selfBody=this.selfBody||this.owner.getComponent(n),!this.selfBody)throw"selfBody can not be empty";var t=j._temp||(j._temp=new b);t.bodyB=this.selfBody.getBody(),t.bodyA=this.otherBody?this.otherBody.getBody():a.I._emptyBody;let i=this.selfBody.getWorldPoint(this.anchor[0],this.anchor[1]);t.anchor.setValue(i.x,i.y);let o=e.Utils.toRadian(this.angle);t.axis.setValue(Math.cos(o),Math.sin(o)),t.enableMotor=this._enableMotor,t.motorSpeed=this._motorSpeed,t.maxMotorForce=this._maxMotorForce,t.enableLimit=this._enableLimit,t.lowerTranslation=this._lowerTranslation,t.upperTranslation=this._upperTranslation,t.collideConnected=this.collideConnected,this._joint=this._factory.create_PrismaticJoint(t)}}}class v extends p{constructor(){super(...arguments),this.selfAnchor=[0,0],this.otherAnchor=[0,0],this.selfGroundPoint=[0,-100],this.otherGroundPoint=[0,-100],this.ratio=1,this.collideConnected=!1}_createJoint(){if(!this._joint){if(!this.otherBody)throw"otherBody can not be empty";if(this.selfBody=this.selfBody||this.owner.getComponent(n),!this.selfBody)throw"selfBody can not be empty";var t=v._temp||(v._temp=new w);t.bodyA=this.otherBody.getBody(),t.bodyB=this.selfBody.getBody();var e=this.otherBody.getWorldPoint(this.otherAnchor[0],this.otherAnchor[1]);t.localAnchorA.setValue(e.x,e.y);var i=this.selfBody.getWorldPoint(this.selfAnchor[0],this.selfAnchor[1]);t.localAnchorB.setValue(i.x,i.y);var o=this.otherBody.getWorldPoint(this.otherGroundPoint[0],this.otherGroundPoint[1]);t.groundAnchorA.setValue(o.x,o.y);var s=this.selfBody.getWorldPoint(this.selfGroundPoint[0],this.selfGroundPoint[1]);t.groundAnchorB.setValue(s.x,s.y),t.ratio=this.ratio,t.collideConnected=this.collideConnected,this._joint=a.I._factory.create_PulleyJoint(t)}}}class T extends p{constructor(){super(...arguments),this._enableMotor=!1,this._motorSpeed=0,this._maxMotorTorque=1e4,this._enableLimit=!1,this._lowerAngle=0,this._upperAngle=0,this.anchor=[0,0],this.collideConnected=!1}get enableMotor(){return this._enableMotor}set enableMotor(t){this._enableMotor=t,this._joint&&this._factory.set_Joint_EnableMotor(this._joint,t)}get motorSpeed(){return this._motorSpeed}set motorSpeed(t){this._motorSpeed=t,this._joint&&this._factory.set_Joint_SetMotorSpeed(this._joint,t)}get maxMotorTorque(){return this._maxMotorTorque}set maxMotorTorque(t){this._maxMotorTorque=t,this._joint&&this._factory.set_Joint_SetMaxMotorTorque(this._joint,t)}get enableLimit(){return this._enableLimit}set enableLimit(t){this._enableLimit=t,this._joint&&this._factory.set_Joint_EnableLimit(this._joint,t)}get lowerAngle(){return this._lowerAngle}set lowerAngle(t){this._lowerAngle=t,this._joint&&this._factory.set_Joint_SetLimits(this._joint,e.Utils.toRadian(t),e.Utils.toRadian(this._upperAngle))}get upperAngle(){return this._upperAngle}set upperAngle(t){this._upperAngle=t,this._joint&&this._factory.set_Joint_SetLimits(this._joint,e.Utils.toRadian(this._lowerAngle),e.Utils.toRadian(t))}_createJoint(){if(!this._joint){if(this.selfBody=this.selfBody||this.owner.getComponent(n),!this.selfBody)throw"selfBody can not be empty";var t=T._temp||(T._temp=new B);t.bodyB=this.selfBody.getBody(),t.bodyA=this.otherBody?this.otherBody.getBody():a.I._emptyBody;let i=this.selfBody.getWorldPoint(this.anchor[0],this.anchor[1]);t.anchor.setValue(i.x,i.y),t.enableMotor=this._enableMotor,t.motorSpeed=this._motorSpeed,t.maxMotorTorque=this._maxMotorTorque,t.enableLimit=this._enableLimit,t.lowerAngle=e.Utils.toRadian(this._lowerAngle),t.upperAngle=e.Utils.toRadian(this._upperAngle),t.collideConnected=this.collideConnected,this._joint=this._factory.create_RevoluteJoint(t)}}}class J extends p{constructor(){super(...arguments),this._frequency=5,this._dampingRatio=.7,this.anchor=[0,0],this.collideConnected=!1}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._joint&&this._factory.set_Joint_frequencyAndDampingRatio(this._joint,this._frequency,this._dampingRatio,!1)}get damping(){return this._dampingRatio}set damping(t){this._dampingRatio=t,this._joint&&this._factory.set_Joint_frequencyAndDampingRatio(this._joint,this._frequency,this._dampingRatio,!0)}_createJoint(){if(!this._joint){if(!this.otherBody)throw"otherBody can not be empty";if(this.selfBody=this.selfBody||this.owner.getComponent(n),!this.selfBody)throw"selfBody can not be empty";var t=J._temp||(J._temp=new S),e=this.selfBody.getWorldPoint(this.anchor[0],this.anchor[1]);t.bodyA=this.otherBody.getBody(),t.bodyB=this.selfBody.getBody(),t.anchor.setValue(e.x,e.y),t.frequency=this._frequency,t.dampingRatio=this._dampingRatio,t.collideConnected=this.collideConnected,this._joint=this._factory.create_WeldJoint(t)}}}class L extends p{constructor(){super(...arguments),this._frequency=1,this._dampingRatio=.7,this._enableMotor=!1,this._motorSpeed=0,this._maxMotorTorque=1e4,this._enableLimit=!0,this._lowerTranslation=0,this._upperTranslation=0,this.anchor=[0,0],this.collideConnected=!1,this._axis=[0,1],this.angle=90}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._joint&&this._factory.set_Joint_frequencyAndDampingRatio(this._joint,this._frequency,this._dampingRatio,!1)}get damping(){return this._dampingRatio}set damping(t){this._dampingRatio=t,this._joint&&this._factory.set_Joint_frequencyAndDampingRatio(this._joint,this._frequency,this._dampingRatio,!0)}get enableMotor(){return this._enableMotor}set enableMotor(t){this._enableMotor=t,this._joint&&this._factory.set_Joint_EnableMotor(this._joint,t)}get motorSpeed(){return this._motorSpeed}set motorSpeed(t){this._motorSpeed=t,this._joint&&this._factory.set_Joint_SetMotorSpeed(this._joint,t)}get maxMotorTorque(){return this._maxMotorTorque}set maxMotorTorque(t){this._maxMotorTorque=t,this._joint&&this._factory.set_Joint_SetMaxMotorTorque(this._joint,t)}get enableLimit(){return this._enableLimit}set enableLimit(t){this._enableLimit=t,this._joint&&this._factory.set_Joint_EnableLimit(this._joint,t)}get lowerTranslation(){return this._lowerTranslation}set lowerTranslation(t){this._lowerTranslation=t,this._joint&&this._factory.set_Joint_SetLimits(this._joint,t,this._upperTranslation)}get upperTranslation(){return this._upperTranslation}set upperTranslation(t){this._upperTranslation=t,this._joint&&this._factory.set_Joint_SetLimits(this._joint,this._lowerTranslation,t)}get axis(){return this._axis}set axis(t){this._axis=t,this.angle=e.Utils.toAngle(Math.atan2(t[1],t[0]))}_createJoint(){if(!this._joint){if(!this.otherBody)throw"otherBody can not be empty";if(this.selfBody=this.selfBody||this.owner.getComponent(n),!this.selfBody)throw"selfBody can not be empty";var t=L._temp||(L._temp=new x),i=this.selfBody.getWorldPoint(this.anchor[0],this.anchor[1]);t.anchor.setValue(i.x,i.y);let o=e.Utils.toRadian(this.angle);t.axis.setValue(Math.cos(o),Math.sin(o)),t.bodyA=this.otherBody.getBody(),t.bodyB=this.selfBody.getBody(),t.enableMotor=this._enableMotor,t.motorSpeed=this._motorSpeed,t.maxMotorTorque=this._maxMotorTorque,t.collideConnected=this.collideConnected,t.enableLimit=this._enableLimit,t.lowerTranslation=this._lowerTranslation,t.upperTranslation=this._upperTranslation,t.frequency=this._frequency,t.dampingRatio=this._dampingRatio,this._joint=this._factory.create_WheelJoint(t)}}}class R extends e.Sprite{get mG(){return this._mG}get textG(){return this._textG}get lineWidth(){return this._lineWidth}get camera(){return this._camera}constructor(t){super(),this._factory=t,this.DrawString_color="#E69999",this.Red="#ff0000",this.Green="#00ff00",this._camera={},this._camera.m_center=new e.Vector2(0,0),this._camera.m_extent=25,this._camera.m_zoom=1,this._camera.m_width=1280,this._camera.m_height=800,this._mG=new e.Graphics,this.graphics=this._mG,this._textSp=new e.Sprite,this._textG=this._textSp.graphics,this.addChild(this._textSp)}_renderToGraphic(){this._factory.world&&(this._textG.clear(),this._mG.clear(),this._mG.save(),this._mG.scale(this._factory.PIXEL_RATIO,this._factory.PIXEL_RATIO),this._lineWidth=this._factory.layaToPhyValue(1),this._factory.world.DebugDraw?this._factory.world.DebugDraw():this._factory.world.DrawDebugData(),this._mG.restore())}render(t,i,o){e.LayaEnv.isPlaying&&(this._renderToGraphic(),super.render(t,i,o))}PushTransform(t,e,i){this._mG.save(),this._mG.translate(t,e),this._mG.rotate(i)}PopTransform(){this._mG.restore()}}let P=e.ClassUtils.regClass;P("Physics2D",a),P("Physics2DDebugDraw",R),P("ColliderBase",h),P("BoxCollider",_),P("ChainCollider",l),P("CircleCollider",d),P("EdgeCollider",c),P("PolygonCollider",y),P("RigidBody",n),P("JointBase",p),P("DistanceJoint",A),P("GearJoint",C),P("MotorJoint",D),P("MouseJoint",M),P("PrismaticJoint",j),P("PulleyJoint",v),P("RevoluteJoint",T),P("WeldJoint",J),P("WheelJoint",L),t.BoxCollider=_,t.ChainCollider=l,t.CircleCollider=d,t.ColliderBase=h,t.DistanceJoint=A,t.EdgeCollider=c,t.FixtureBox2DDef=o,t.GearJoint=C,t.JointBase=p,t.MotorJoint=D,t.MouseJoint=M,t.Physics2D=a,t.Physics2DDebugDraw=R,t.Physics2DOption=s,t.PolygonCollider=y,t.PrismaticJoint=j,t.PulleyJoint=v,t.RevoluteJoint=T,t.RigidBody=n,t.RigidBody2DInfo=r,t.WeldJoint=J,t.WheelJoint=L,t.physics2D_DistancJointDef=g,t.physics2D_GearJointDef=u,t.physics2D_MotorJointDef=f,t.physics2D_MouseJointJointDef=m,t.physics2D_PrismaticJointDef=b,t.physics2D_PulleyJointDef=w,t.physics2D_RevoluteJointDef=B,t.physics2D_WeldJointDef=S,t.physics2D_WheelJointDef=x}(window.Laya=window.Laya||{},Laya);